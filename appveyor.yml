version: "{build}"

platform: x64

clone_folder: c:\gopath\src\github.com\tochka\test-travis

environment:
  GOPATH: c:\gopath

skip_branch_with_pr: true

pull_requests:
  do_not_increment_build_number: true

install:  
  - echo %PATH%
  - echo %GOPATH%
  - set PATH=%GOPATH%\bin;c:\go\bin;c:\MinGW\bin\;%PATH%
  - go version
  - go env
  - echo %APPVEYOR_REPO_TAG_NAME%
  - echo %APPVEYOR_REPO_BRANCH%
  - copy c:\MinGW\bin\mingw32-make.exe c:\MinGW\bin\make.exe
  - dir C:\MinGW\msys\1.0
  - C:\MinGW\msys\1.0\msys.bat install msys-zip
  - make get
  
test_script:
  - make test_all
  
build_script:  
   - make
   - make build_artifact

artifacts:
  - path: build\windows-amd64.zip
